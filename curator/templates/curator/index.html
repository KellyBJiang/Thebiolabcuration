{% extends "administrator/header.html" %}
{% block content %}
	{% if request.user.is_authenticated %}
		<!--navbar-->
		<nav class="navbar navbar-default" style="background-color: #e3f2fd;">
			<div class = "continer">
				<div class = "row">
					<div class = "col-sm-1">
						
					</div>
					<div class = "col-sm-1">
						<form method="post" name = "selector_topic">
					     	{% csrf_token %}
							<select name="selector" onchange="reply_select()"  style="margin-top:20px">
								<option value=-1 >All topics</option>
								{% for topic in topics %}
									{% if select_topic == topic.pk %}
										<option value={{topic.pk}} selected>{{topic.topic}}</option>
									{% else %}
										<option value={{topic.pk}} >{{topic.topic}}</option>
									{% endif %}
								{% endfor %}
							</select>
							<input id="select_button" style="display: none;" type="submit" value="Select">
						</form>
					</div>
					<div class = "col-sm-6">
				    	<div id = "nav"></div>
				    </div>
				    <div class = "col-sm-2">
					    <ul class="nav navbar-nav navbar-right"> 
							 <li> <a href="/logout/">Log Out </a></li>
						</ul>    
					</div>
				</div>
			</div>
		</nav>
		<div class="container">
			<div id="display">	
			</div>
		</div>
		
<script>
	// var select_topic = document.getElementById("topic").value;
	// console.log(select_topic);
	//   function SelectTopic()
	//   {
	//   	select_topic = document.getElementById("topic").value;
	//   	console.log(select_topic);
	//   }
	
	
	
	function reply_select()
	{
		document.getElementById("select_button").click();
	}
	
	
	
	
	reply_click(0);

    function reply_click(clicked_id)
    {
       if(clicked_id == 0) //To do
       {
       		document.getElementById("nav").innerHTML = 
       		'<ul class="nav navbar-nav">'+
       		'<li id="0" onClick="reply_click(this.id)" class = "active"><a href="#">To Do</a></li>'+
       		'<li id="1" onClick="reply_click(this.id)"><a href="#">Submitted</a></li>'+
       		'<li id="2" onClick="reply_click(this.id)"><a href="#">Undecided</a></li>'+
       		'</ul>';
       		
           document.getElementById("display").innerHTML = 
        		"<h5>Welcome  {{user.username}}, you have {{datasets_count}} assigments:</h5>"+
     	        	"<table id='to_do' class='table table-hover'>"+
     	        		"<thead><tr><th>Accession</th><th>Title</th><th>Keywords</th></tr></thead>"+
    	        		"<tbody>"+
    	        		    "{% for c in  c_ids%}"+
    	        				"{% for data in datasets %}"+
    	        					"{% with tid=1 %}"+
	    	        					"{% if select_topic < 0  %}"+
	    	        						"{% if data.id == c.data_id_id%}"+
	    	        							"<tr><td>{{data.accNo}}</td><td align='left'><a href ='/curator/{{user_id}}/dataset/{{data.id}}/{{c.id}}'>{{c.data_id}}</a></td><td>{{data.keywords}}</td></tr>"+
	    	        						"{% endif %}"+
	    	        					"{% else %}"+
	    	        						"{% if  data.id == c.data_id_id and data.topic == select_topic%}"+
	    	        							"<tr><td>{{data.accNo}}</td><td align='left'><a href ='/curator/{{user_id}}/dataset/{{data.id}}/{{c.id}}'>{{c.data_id}}</a></td><td>{{data.keywords}}</td></tr>"+
											"{% endif%}"+
	    	        					"{% endif %}"+
    	        					"{% endwith %}"+
    	        				"{% endfor %}"+
    	        			"{% endfor%}"+
			  			"</tbody>"+
			  		"</table>";
       }
        if(clicked_id==1) //Submitted
        {
        	document.getElementById("nav").innerHTML = 
       		'<ul class="nav navbar-nav">'+
       		'<li id="0" onClick="reply_click(this.id)"><a href="#">To Do</a></li>'+
       		'<li id="1" onClick="reply_click(this.id)" class = "active"><a href="#">Submitted</a></li>'+
       		'<li id="2" onClick="reply_click(this.id)"><a href="#">Undecided</a></li>'+
       		'</ul>';
            var content = document.getElementById("display");
            content.innerHTML = 
            	"<h5>Welcome  {{user.username}}, you have {{datasets_submitted_count}} submitted assigments:</h5>"+
       	        	"<table id='submitted' class='table'>"+
       	        		"<thead><tr><th>Accession</th><th>Title</th><th>Keywords</th><th>Result</th></tr></thead>"+
       	        		"<tbody>"+
       	        			"{% for c in  c_s %}"+
       	    	        		"{% for data in datasets_submitted %}"+
       	    	        			"{% if select_topic < 0  %}"+
	    	        					"{% if data.id == c.data_id_id %}"+
	    	        						"{%  if c.result == 'Y' %}"+
	    	        							"<tr><td>{{data.accNo}}</td><td align='left'><a href ='/curator/{{user_id}}/dataset/{{data.id}}/{{c.id}}'>{{c.data_id}}</a></td><td>{{data.keywords}}</td><td>Yes</td></tr>"+
	    	        						"{% elif c.result == 'N'%}"+
	    	        							"<tr><td>{{data.accNo}}</td><td align='left'><a href ='/curator/{{user_id}}/dataset/{{data.id}}/{{c.id}}'>{{c.data_id}}</a></td><td>{{data.keywords}}</td><td>No</td></tr>"+
											"{% elif c.result == 'U'%}"+
												"<tr><td>{{data.accNo}}</td><td align='left'><a href ='/curator/{{user_id}}/dataset/{{data.id}}/{{c.id}}'>{{c.data_id}}</a></td><td>{{data.keywords}}</td><td>Undecided</td></tr>"+
	    	        						"{%  endif %}"+
	    	        						// "<tr><td>{{data.accNo}}</td><td align='left'><a href ='/curator/{{user_id}}/dataset/{{data.id}}/{{c.id}}'>{{c.data_id}}</a></td><td>{{res}}</td></tr>"+
	    	        					"{% endif %}"+
	    	        				"{% else %}"+
	    	        					"{% if data.id == c.data_id_id and data.topic == select_topic%}"+
	    	        						"{%  if c.result == 'Y' %}"+
	    	        							"<tr><td>{{data.accNo}}</td><td align='left'><a href ='/curator/{{user_id}}/dataset/{{data.id}}/{{c.id}}'>{{c.data_id}}</a></td><td>{{data.keywords}}</td><td>Yes</td></tr>"+
	    	        						"{% elif c.result == 'N'%}"+
	    	        							"<tr><td>{{data.accNo}}</td><td align='left'><a href ='/curator/{{user_id}}/dataset/{{data.id}}/{{c.id}}'>{{c.data_id}}</a></td><td>{{data.keywords}}</td><td>No</td></tr>"+
											"{% elif c.result == 'U'%}"+
												"<tr><td>{{data.accNo}}</td><td align='left'><a href ='/curator/{{user_id}}/dataset/{{data.id}}/{{c.id}}'>{{c.data_id}}</a></td><td>{{data.keywords}}</td><td>Undecided</td></tr>"+
	    	        						"{%  endif %}"+
	    	        						// "<tr><td>{{data.accNo}}</td><td align='left'><a href ='/curator/{{user_id}}/dataset/{{data.id}}/{{c.id}}'>{{c.data_id}}</a></td><td>{{res}}</td></tr>"+
	    	        					"{% endif %}"+
	    	        				"{% endif %}"+
    	        				"{% endfor %}"+
    	        			"{% endfor%}"+
			  	  //  		"{% for data in datasets_submitted %}"+
								// "<tr><td>{{data.accNo}}</td><td align='left'><a href ='/curator/{{user_id}}/dataset/{{data.id}}'>{{data.title}}</a></td></tr>"+
			  	  //  		"{% endfor %}"+
			  			"</tbody>"+
			  		"</table>";
        }
        if(clicked_id==2)  //Undecided
        {
        	document.getElementById("nav").innerHTML = 
       		'<ul class="nav navbar-nav">'+
       		'<li id="0" onClick="reply_click(this.id)"><a href="#">To Do</a></li>'+
       		'<li id="1" onClick="reply_click(this.id)"><a href="#">Submitted</a></li>'+
       		'<li id="2" onClick="reply_click(this.id)" class = "active"><a href="#">Undecided</a></li>'+
       		'</ul>';
            document.getElementById("display").innerHTML = 
            	"<h5>Welcome  {{user.username}}, you have {{datasets_undicided_count}} undicided assigments:</h5>"+
       	        	"<table id='undecided' class='table'>"+
       	        		"<thead><tr><th>Accession</th><th>Title</th><th>Keywords</th></tr></thead>"+
       	        		"<tbody>"+
       	        			"{% for c in c_u %}"+
       	        				"{% if select_topic < 0  %}"+
	       	    	        		"{% for data in datasets_undicided %}"+
	    	        					"{% if data.id == c.data_id_id %}"+
	    	        						"<tr><td>{{data.accNo}}</td><td align='left'><a href ='/curator/{{user_id}}/dataset/{{data.id}}/{{c.id}}'>{{c.data_id}}</a></td><td>{{data.keywords}}</td></tr>"+
	    	        					"{% endif %}"+
	    	        				"{% endfor %}"+
	    	        			"{% else %}"+
	    	        				"{% for data in datasets_undicided %}"+
	    	        					"{% if data.id == c.data_id_id and data.topic == select_topic%}"+
	    	        						"<tr><td>{{data.accNo}}</td><td align='left'><a href ='/curator/{{user_id}}/dataset/{{data.id}}/{{c.id}}'>{{c.data_id}}</a></td><td>{{data.keywords}}</td></tr>"+
	    	        					"{% endif %}"+
	    	        				"{% endfor %}"+
	    	        			"{% endif %}"+
    	        			"{% endfor%}"+
			  			"</tbody>"+
			  		"</table>";
        }
       $('.table').DataTable({
		        "pagingType": "full_numbers",
		        "paging":   true,
		        "ordering": false,
		        "filter": true,
		        "info": true,
		        "iDisplayLength": 10,
		        "lengthMenu": [[3, 10, 25, 50, -1], [3, 10, 25, 50, "All"]]
	    });
    }
    $(document).ready(function() 
    {
    	reply_click(0);
	});
   </script>




<!--<div class="row">-->
<!--	<div class="text-center">-->
<!--		<div class="pagination" >-->
<!--		{% if datasets.has_other_pages %}-->
<!--			<ul class="pagination">-->
<!--				{% if datasets.has_previous %}-->
<!--					<li><a href="?page={{ datasets.previous_page_number }}">&laquo;</a></li>-->
<!--				{% else %}-->
<!--					<li class="disabled"><span>&laquo;</span></li>-->
<!--				{% endif %}-->
					
<!--				{% for i in datasets.paginator.page_range %}-->
<!--					{% if users.number == i %}-->
<!--						<li class="active"><span>{{ i }} <span class="sr-only">(current)</span></span></li>-->
<!--					{% else %}-->
<!--					    <li><a href="?page={{ i }}">{{ i }}</a></li>-->
<!--					{% endif %}-->
<!--				{% endfor %}-->
				
<!--				{% if datasets.has_next %}-->
<!--					<li><a href="?page={{ datasets.next_page_number }}">&raquo;</a></li>-->
<!--				{% else %}-->
<!--					<li class="disabled"><span>&raquo;</span></li>-->
<!--				{% endif %}-->
<!--			</ul>-->
<!--		{% endif %}-->
<!--		</div>-->
<!--	</div>-->
<!--</div>-->


{% else %}
<p>You must login first</p>
{% endif %}
{% endblock %}		
